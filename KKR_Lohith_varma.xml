<?xml version="1.0"?>
<robot name="fish_hpurv">

    <material name="red">
        <color rgba="1.0 0.0 0.0 0.0"/>
    </material>

    <!-- Fish Body Definition -->
    <link name="body">
        <visual>
            <geometry>
                <box size="1.0 0.5 0.3"/> <!-- Fish body: Long box -->
            </geometry>
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/> <!-- Positioned above ground -->
            <material name="red"/>
        </visual>
        <collision>
            <geometry>
                <box size="2.0 0.5 0.3"/> <!-- Fish body collision -->
            </geometry>
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
        </collision>
        <inertial>
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
            <mass value="30.0"/>
            <inertia ixx="10.0" ixy="0.0" ixz="0.0" iyy="10.0" iyz="0.0" izz="20.0"/>
        </inertial>
    </link>

    <!-- Left Fin Definition (Thin Plate) -->
    <link name="fin_left">
        <visual>
            <geometry>
                <box size="0.5 0.05 0.2"/> <!-- Left fin: Thin plate -->
            </geometry>
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/> <!-- Positioned on the side -->
            <material name="red"/>
        </visual>
        <collision>
            <geometry>
                <box size="0.5 0.05 0.2"/> <!-- Left fin collision -->
            </geometry>
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
        </collision>
        <inertial>
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
            <mass value="2.0"/>
            <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.1" iyz="0.0" izz="0.1"/>
        </inertial>
    </link>

    <!-- Right Fin Definition (Thin Plate) -->
    <link name="fin_right">
        <visual>
            <geometry>
                <box size="0.5 0.05 0.2"/> <!-- Right fin: Thin plate -->
            </geometry>
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.00 0.00"/> <!-- Positioned on the opposite side -->
            <material name="red"/>
        </visual>
        <collision>
            <geometry>
                <box size="0.5 0.05 0.2"/> <!-- Right fin collision -->
            </geometry>
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
        </collision>
        <inertial>
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
            <mass value="2.0"/>
            <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.1" iyz="0.0" izz="0.1"/>
        </inertial>
    </link>

    <!-- Caudal (Tail) Fin Definition -->
    <link name="caudal_fin">
        <visual>
            <geometry>
                <box size="0.5 0.05 0.2"/> <!-- Caudal fin: Thin plate -->
            </geometry>
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/> <!-- Positioned at the back -->
            <material name="red"/>
        </visual>
        <collision>
            <geometry>
                <box size="0.5 0.05 0.2"/> <!-- Caudal fin collision -->
            </geometry>
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
        </collision>
        <inertial>
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
            <mass value="3.0"/>
            <inertia ixx="0.2" ixy="0.0" ixz="0.0" iyy="0.2" iyz="0.0" izz="0.2"/>
        </inertial>
    </link>

    <!-- Left Fin Joint (Revolute) -->
    <joint name="left_fin_joint" type="revolute">
        <parent link="body"/>
        <child link="fin_left"/>
        <origin rpy="1.57 0 1.57" xyz="0.0 0.25 0.0"/>
        <axis xyz="1 0 0"/>
        <limit effort="10.0" lower="-1.57" upper="1.57" velocity="1.0"/>
    </joint>

    <!-- Right Fin Joint (Revolute) -->
    <joint name="right_fin_joint" type="revolute">
        <parent link="body"/>
        <child link="fin_right"/>
        <origin rpy="1.57 0 1.57" xyz="0.0 -0.25 0.0"/>
        <axis xyz="1 0 0"/>
        <limit effort="10.0" lower="-1.57" upper="1.57" velocity="1.0"/>
    </joint>

    <!-- Caudal Fin Joint (Revolute) -->
    <joint name="caudal_fin_joint" type="revolute">
        <parent link="body"/>
        <child link="caudal_fin"/>
        <origin rpy="0 1.57 3.14" xyz="-0.55 0.0 0.0"/>
        <axis xyz="0 0 1"/>
        <limit effort="10.0" lower="-1.57" upper="1.57" velocity="1.0"/>
    </joint>

    <!-- Fixed Joint for Root Link (base_link1) to prevent falling -->
    <gazebo>
        <plugin name="fish_hpurv_uuv_plugin" filename="/home/uav/ros2_ws/install/uuv_gazebo_ros_plugins/lib/libuuv_underwater_object_ros_plugin.so">
            <fluid_density>1028.0</fluid_density>
            <flow_velocity_topic>hydrodynamics/current_velocity</flow_velocity_topic>
            <debug>1</debug>
            <center_of_buoyancy>0 0 0.3</center_of_buoyancy> <!-- Set the center of buoyancy -->
            <volume>1.83826</volume> <!-- Set the volume -->
            <neutrally_buoyant>0</neutrally_buoyant> <!-- Adjust buoyancy as needed -->

            <!-- Added Mass -->
            <added_mass>
                1     0     0     0     0     0
                0     16    0     0     0     0
                0     0     16    0     0     0
                0     0     0     0.005 0     0
                0     0     0     0     1.3   0
                0     0     0     0     0     1.3
            </added_mass>

            <!-- Linear Damping -->
            <linear_damping>
                -2.4  0     0     0     0     0
                0     -23   0     0     0     11.5
                0     0     -23   0     -11.5 0
                0     0     0     -0.3  0     0
                0     0     3.1   0     -9.7  0
                0     -3.1  0     0     0     -9.7
            </linear_damping>

            <!-- Quadratic Damping -->
            <quadratic_damping>
                -2.4   0      0      0       0      0
                0      -80    0      0       0      0.3
                0      0      -80    0       -0.3   0
                0      0      0      -0.0006 0      0
                0      0      1.5    0       -9.1   0
                0      -1.5   0      0       0      -9.1
            </quadratic_damping>

        </plugin>
    </gazebo>

</robot>
